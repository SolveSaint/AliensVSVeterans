@use "./base.scss";

/* =========================
   STRONG GLOBAL TEXTURED BACKGROUND
   ========================= */
body {
  background-color: #0b0e11;

  background-image:
    radial-gradient(
      ellipse at center,
      rgba(255, 255, 255, 0.06) 0%,
      rgba(255, 255, 255, 0.03) 35%,
      rgba(0, 0, 0, 0.35) 70%,
      rgba(0, 0, 0, 0.6) 100%
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.08) 1px,
      transparent 1px
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.04) 1px,
      transparent 1px
    );

  background-size:
    100% 100%,
    5px 5px,
    2px 2px;

  background-position:
    center,
    0 0,
    1px 1px;
}

/* =========================
   GLOBAL WIDTH SAFETY
   ========================= */
html,
body,
#quartz-root,
#quartz-body {
  width: 100%;
  max-width: 100%;
}

/* Prevent layout blowouts */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Media should never push width */
img,
svg,
video,
canvas {
  max-width: 100%;
  height: auto;
}

/* Code blocks scroll internally, not the page */
pre {
  max-width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

code {
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Wrap long text in the reading area only */
.center article p,
.center article li,
.center article blockquote,
.center article h1,
.center article h2,
.center article h3,
.center article h4,
.center article h5,
.center article h6,
.center article strong,
.center article em,
.center article a {
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

/* Allow flex children to shrink on mobile */
#quartz-body,
.center,
main,
article,
.content {
  min-width: 0;
}

/* =========================
   GLOBAL LAYOUT PULL UP
   ========================= */
#quartz-root,
#quartz-body,
.center,
.center .page-header,
.center .page-header header {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

.center .page-header header {
  margin: 0 !important;
  padding: 0 !important;
}

.center .page-header header > div {
  margin-bottom: 0 !important;
}

.center .page-header figure,
.center .page-header picture {
  margin: 0 !important;
}

.center .page-header img,
.center .page-header a {
  display: block;
}

/* =========================
   SIDEBARS
   ========================= */
.left.sidebar,
.right.sidebar {
  margin-top: 0 !important;
  padding-top: 1rem !important;
}

.left.sidebar .page-title {
  margin-top: 0 !important;
}

.right.sidebar .graph {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

#quartz-body {
  align-items: flex-start !important;
}

/* =========================
   FAKE H1 HERO TITLE
   ========================= */
.avv-title {
  white-space: nowrap;
  font-size: clamp(2.4rem, 4.2vw, 3.6rem);
  font-weight: 500;
  line-height: 1.08;
  margin: 0 0 2rem 0;
  color: #cfd6e6;
  text-align: center;
  letter-spacing: 0.01em;
  transform: translateZ(0);
  text-shadow:
    0 1px 2px rgba(0, 0, 0, 0.8),
    0 4px 12px rgba(0, 0, 0, 0.45);
  animation: avvFadeIn 600ms ease-out both;
}

.avv-title span {
  display: inline;
}

.avv-title::after {
  content: "";
  display: block;
  width: 360px;
  height: 7px;
  margin: 0.8rem auto 0;
  background: linear-gradient(90deg, #c43c3c, #ffffff, #1f4ed8);
  border-radius: 2px;
  opacity: 0.85;
}

/* Color tokens */
.avv-welcome {
  color: #f2c94c;
  font-weight: 500;
  opacity: 0.92;
  text-shadow: 0 0 14px rgba(242, 201, 76, 0.45);
}

.avv-aliens {
  color: #c43c3c;
  font-weight: 500;
  letter-spacing: 0.01em;
  text-shadow: 0 0 14px rgba(196, 60, 60, 0.45);
}

.avv-veterans {
  color: #1f4ed8;
  font-weight: 500;
  letter-spacing: 0.01em;
  text-shadow: 0 0 14px rgba(31, 78, 216, 0.45);
}

.avv-welcome,
.avv-aliens,
.avv-veterans {
  letter-spacing: 0.01em;
}

@keyframes avvFadeIn {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* =========================
   META ROW TIGHTENING
   ========================= */
.page-meta,
.content-meta,
.breadcrumb,
.breadcrumbs {
  margin-top: 0.25rem !important;
}

.center .page-header .popover-hint,
.center .page-header .content-meta {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

.center .page-header .content-meta {
  margin-bottom: 0.35rem !important;
}

/* =========================
   TOP LEFT SITE TITLE
   ========================= */
.left.sidebar .page-title a {
  font-weight: 600;
  letter-spacing: 0.01em;
  text-decoration: none;

  background: linear-gradient(
    90deg,
    #c43c3c 0%,
    #c43c3c 38%,
    #ffffff 38%,
    #ffffff 52%,
    #1f4ed8 52%,
    #1f4ed8 100%
  );
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;

  text-shadow:
    0 0 14px rgba(196, 60, 60, 0.25),
    0 0 14px rgba(31, 78, 216, 0.25);
}

/* Do not let the site title break per character */
.left.sidebar .page-title,
.left.sidebar .page-title a {
  overflow-wrap: normal !important;
  word-break: keep-all !important;
  hyphens: none !important;
  white-space: nowrap !important;
}

/* =========================
   MOBILE: WRAP HERO TITLE
   ========================= */
@media (max-width: 700px) {
  .avv-title {
    white-space: normal;
    text-wrap: balance;
  }

  .avv-title::after {
    width: min(360px, 92vw);
  }
}

/* =========================
   MOBILE: FIX HEADER ROW (TITLE + SEARCH)
   Make the search box shrink so AVSV shows fully
   ========================= */
@media (max-width: 700px) {
  .left.sidebar {
    width: 100% !important;
    max-width: 100% !important;
  }

  .left.sidebar .page-title {
    min-width: 0 !important;
  }

  .left.sidebar .page-title a {
    max-width: none !important;
    overflow: visible !important;
    text-overflow: clip !important;
  }

  /* Shrink search so the title can show */
  .left.sidebar input[type="search"],
  .left.sidebar .search input,
  .left.sidebar .searchbar input {
    width: 9.5rem !important;
    max-width: 9.5rem !important;
  }

  /* Prevent search container from eating the row */
  .left.sidebar .search,
  .left.sidebar .searchbar {
    flex: 0 0 auto !important;
  }
}

/* =========================
   MOBILE FONT SIZE BOOST
   ========================= */
@media (max-width: 700px) {
  body {
    font-size: 1.05rem;
  }

  p,
  li,
  blockquote {
    font-size: 1.1rem;
    line-height: 1.65;
  }

  h1 {
    font-size: 1.6rem;
  }

  h2 {
    font-size: 1.4rem;
  }

  h3 {
    font-size: 1.25rem;
  }

  h4 {
    font-size: 1.15rem;
  }

  .left.sidebar,
  .right.sidebar {
    font-size: 0.95rem;
  }

  .page-meta,
  .content-meta,
  .breadcrumb,
  .breadcrumbs {
    font-size: 0.85rem;
  }
}

/* =========================
   FORCE DARK MODE ONLY
   ========================= */
:root {
  color-scheme: dark !important;
}

html[data-theme="light"],
html[data-theme="light"] body {
  background-color: #0b0e11 !important;
  color: #cfd6e6 !important;
}

html,
html[data-theme],
html[data-theme="dark"] {
  --background: #0b0e11 !important;
  --text: #cfd6e6 !important;
}

/* =========================
   REMOVE THEME TOGGLE (MOON ICON)
   ========================= */
button[aria-label*="theme"],
button[title*="theme"],
button[aria-label*="dark"],
button[aria-label*="light"],
a[aria-label*="theme"],
a[title*="theme"],
svg[data-icon*="moon"],
svg[data-icon*="sun"],
.theme-toggle,
.theme-switch,
.darkmode-toggle,
.lightmode-toggle {
  display: none !important;
}

/* =========================
   REMOVE BOOK ICON
   ========================= */
button[aria-label*="reader"],
button[title*="reader"],
button[aria-label*="book"],
button[title*="book"],
a[aria-label*="reader"],
a[title*="reader"],
a[aria-label*="book"],
a[title*="book"],
svg[data-icon*="book"],
.book,
.book-toggle,
.reader-toggle {
  display: none !important;
}
/* =========================
   EXPLORER ACTIVE LINK
   ========================= */
.explorer-content a.is-active {
  background-color: rgba(96, 163, 255, 0.24);
  color: #e6f0ff;
  border-radius: 8px;
  box-shadow: inset 2px 0 0 rgba(96, 163, 255, 0.75);
}

.explorer-content a.is-active::after {
  background: rgba(96, 163, 255, 0.22);
}

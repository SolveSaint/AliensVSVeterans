@use "./base.scss";

/* Strong global textured background */
body {
  background-color: #0b0e11;

  background-image:
    radial-gradient(
      ellipse at center,
      rgba(255, 255, 255, 0.06) 0%,
      rgba(255, 255, 255, 0.03) 35%,
      rgba(0, 0, 0, 0.35) 70%,
      rgba(0, 0, 0, 0.6) 100%
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.08) 1px,
      transparent 1px
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.04) 1px,
      transparent 1px
    );

  background-size:
    100% 100%,
    5px 5px,
    2px 2px;

  background-position:
    center,
    0 0,
    1px 1px;
}

/* =========================
   GLOBAL WIDTH SAFETY
   ========================= */
html,
body,
#quartz-root,
#quartz-body {
  width: 100%;
  max-width: 100%;
}

/* Do NOT cap everything to max-width:100% globally.
   That blocks horizontal pan and can force clipping in flex layouts. */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Wrap long strings in reading content */
p,
li,
blockquote,
h1,
h2,
h3,
h4,
h5,
h6,
strong,
em {
  overflow-wrap: anywhere;
  word-break: break-word;
  hyphens: auto;
}

/* Media should never push width */
img,
svg,
video,
canvas {
  max-width: 100%;
  height: auto;
}

/* Code blocks scroll internally, not the page */
pre {
  max-width: 100%;
  overflow-x: auto;
}

code {
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* =========================
   GLOBAL LAYOUT PULL-UP
   ========================= */
#quartz-root,
#quartz-body,
.center,
.center .page-header,
.center .page-header header {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

.center .page-header header {
  margin: 0 !important;
  padding: 0 !important;
}

.center .page-header header > div {
  margin-bottom: 0 !important;
}

.center .page-header figure,
.center .page-header picture {
  margin: 0 !important;
}

.center .page-header img,
.center .page-header a {
  display: block;
}

/* =========================
   SIDEBARS
   ========================= */
.left.sidebar,
.right.sidebar {
  margin-top: 0 !important;
  padding-top: 1rem !important;
}

.left.sidebar .page-title {
  margin-top: 0 !important;
}

.right.sidebar .graph {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

#quartz-body {
  align-items: flex-start !important;
}

/* =========================
   FAKE H1 HERO TITLE
   ========================= */
.avv-title {
  white-space: nowrap;
  font-size: clamp(2.4rem, 4.2vw, 3.6rem);
  font-weight: 500;
  line-height: 1.08;
  margin: 0 0 2rem 0;
  color: #cfd6e6;
  text-align: center;
  letter-spacing: 0.01em;
  transform: translateZ(0);
  text-shadow:
    0 1px 2px rgba(0, 0, 0, 0.8),
    0 4px 12px rgba(0, 0, 0, 0.45);
  animation: avvFadeIn 600ms ease-out both;
}

.avv-title span {
  display: inline;
}

.avv-title::after {
  content: "";
  display: block;
  width: 360px;
  height: 7px;
  margin: 0.8rem auto 0;
  background: linear-gradient(90deg, #c43c3c, #ffffff, #1f4ed8);
  border-radius: 2px;
  opacity: 0.85;
}

/* =========================
   COLOR TOKENS
   ========================= */
.avv-welcome {
  color: #f2c94c;
  font-weight: 500;
  opacity: 0.92;
  text-shadow: 0 0 14px rgba(242, 201, 76, 0.45);
}

.avv-aliens {
  color: #c43c3c;
  font-weight: 500;
  letter-spacing: 0.01em;
  text-shadow: 0 0 14px rgba(196, 60, 60, 0.45);
}

.avv-veterans {
  color: #1f4ed8;
  font-weight: 500;
  letter-spacing: 0.01em;
  text-shadow: 0 0 14px rgba(31, 78, 216, 0.45);
}

.avv-welcome,
.avv-aliens,
.avv-veterans {
  letter-spacing: 0.01em;
}

@keyframes avvFadeIn {
  from {
    opacity: 0;
    transform: translateY(6px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* =========================
   META ROW TIGHTENING
   ========================= */
.page-meta,
.content-meta,
.breadcrumb,
.breadcrumbs {
  margin-top: 0.25rem !important;
}

.center .page-header .popover-hint,
.center .page-header .content-meta {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

.center .page-header .content-meta {
  margin-bottom: 0.35rem !important;
}

/* =========================
   TOP-LEFT SITE TITLE
   ========================= */
.left.sidebar .page-title a {
  font-weight: 600;
  letter-spacing: 0.01em;
  text-decoration: none;

  background: linear-gradient(
    90deg,
    #c43c3c 0%,
    #c43c3c 38%,
    #ffffff 38%,
    #ffffff 52%,
    #1f4ed8 52%,
    #1f4ed8 100%
  );
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;

  text-shadow:
    0 0 14px rgba(196, 60, 60, 0.25),
    0 0 14px rgba(31, 78, 216, 0.25);
}

/* =========================
   MOBILE FONT SIZE BOOST
   ========================= */
@media (max-width: 700px) {
  body {
    font-size: 1.05rem;
  }

  p,
  li,
  blockquote {
    font-size: 1.1rem;
    line-height: 1.65;
  }

  h1 {
    font-size: 1.6rem;
  }

  h2 {
    font-size: 1.4rem;
  }

  h3 {
    font-size: 1.25rem;
  }

  h4 {
    font-size: 1.15rem;
  }

  .left.sidebar,
  .right.sidebar {
    font-size: 0.95rem;
  }

  .page-meta,
  .content-meta,
  .breadcrumb,
  .breadcrumbs {
    font-size: 0.85rem;
  }
}

/* =========================
   MOBILE: FIX TOP LEFT TITLE LAYOUT
   ========================= */
@media (max-width: 700px) {
  .left.sidebar {
    width: 100% !important;
    max-width: 100% !important;
  }

  .left.sidebar .page-title {
    margin: 0 !important;
    min-width: 0 !important;
  }

  .left.sidebar .page-title a {
    display: block !important;
    max-width: 100% !important;

    overflow-wrap: normal !important;
    word-break: keep-all !important;
    hyphens: none !important;

    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
}

/* =========================
   MOBILE: FIX RIGHT SIDE CLIPPING IN CONTENT
   ========================= */
@media (max-width: 700px) {
  /* The most common Quartz culprit is a flex child with min-width:auto.
     Force shrink so text can wrap instead of being cut off. */
  #quartz-body,
  .center,
  main,
  article,
  .content,
  .page,
  .page-content,
  .content-container {
    min-width: 0 !important;
    max-width: 100% !important;
  }

  /* Ensure the main content column actually spans the viewport */
  .center {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Keep headings from creating overflow, wrap by words not letters */
  .center h1,
  .center h2,
  .center h3 {
    overflow-wrap: anywhere;
    word-break: break-word;
    hyphens: auto;
  }
}
/* =========================
   MOBILE: HERO TITLE WRAP CLEANLY
   ========================= */
@media (max-width: 700px) {
  .avv-title {
    white-space: normal !important;
    max-width: 100% !important;

    /* allow word wrapping but never character stacking */
    overflow-wrap: normal !important;
    word-break: keep-all !important;
    hyphens: none !important;

    text-align: center;
    line-height: 1.15;
  }
}
/* =========================
   MOBILE: STOP RIGHT OVERFLOW (HEADER + HERO)
   ========================= */
@media (max-width: 700px) {
  /* 1) Kill any remaining horizontal overflow at the layout level */
  html,
  body {
    overflow-x: hidden !important;
  }

  /* 2) Flex shrink fixes (this is what usually causes the “can’t go right” issue) */
  header,
  nav,
  .page-header,
  .page-header header,
  #quartz-body,
  .center {
    min-width: 0 !important;
    max-width: 100% !important;
  }

  /* 3) Make the top bar row shrink instead of forcing width */
  .left.sidebar {
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  .left.sidebar .page-title {
    min-width: 0 !important;
    max-width: 100% !important;
  }

  .left.sidebar .page-title a {
    display: block !important;
    min-width: 0 !important;
    max-width: 100% !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;

    /* prevent per-letter stacking */
    overflow-wrap: normal !important;
    word-break: keep-all !important;
    hyphens: none !important;
  }

  /* 4) HERO TITLE: hard wrap by words and never exceed viewport */
  .avv-title {
    white-space: normal !important;
    max-width: 92vw !important;
    margin-left: auto !important;
    margin-right: auto !important;

    overflow-wrap: normal !important;
    word-break: normal !important;
    hyphens: none !important;

    text-align: center !important;
    line-height: 1.15 !important;
  }
}

@use "./base.scss";

/* =========================
   BASE PAGE BACKGROUND
   Night forest green bias + texture
   ========================= */

body {
  background-color: #0a120e;

  background-image:
    radial-gradient(
      ellipse at center,
      rgba(255, 255, 255, 0.055) 0%,
      rgba(255, 255, 255, 0.028) 35%,
      rgba(0, 0, 0, 0.36) 70%,
      rgba(0, 0, 0, 0.64) 100%
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.07) 1px,
      transparent 1px
    ),
    radial-gradient(
      rgba(255, 255, 255, 0.035) 1px,
      transparent 1px
    );

  background-size:
    100% 100%,
    5px 5px,
    2px 2px;

  background-position:
    center,
    0 0,
    1px 1px;

  background-repeat:
    no-repeat,
    repeat,
    repeat;
}

/* Put the whole Quartz app above our background layers */
#quartz-root,
#quartz-body {
  position: relative;
  z-index: 2;
}

/* =========================
   SIDE CAMO LAYER
   Uses emitted Quartz static asset:
   /static/camo-side.svg
   ========================= */

body::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;

  /* Fade in below the header */
  -webkit-mask-image: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0) 0%,
    rgba(0, 0, 0, 0) 14%,
    rgba(0, 0, 0, 0.7) 30%,
    rgba(0, 0, 0, 1) 100%
  );
  mask-image: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0) 0%,
    rgba(0, 0, 0, 0) 14%,
    rgba(0, 0, 0, 0.7) 30%,
    rgba(0, 0, 0, 1) 100%
  );

  /* Two sides plus soft edge fades and speckle */
  background-image:
    /* Left camo */
    url("/static/camo-side.svg"),
    /* Right camo */
    url("/static/camo-side.svg"),
    /* Left edge dark fade */
    linear-gradient(to right, rgba(0, 0, 0, 0.72) 0%, rgba(0, 0, 0, 0) 26%),
    /* Right edge dark fade */
    linear-gradient(to left, rgba(0, 0, 0, 0.72) 0%, rgba(0, 0, 0, 0) 26%),
    /* Fine speckle to break banding */
    radial-gradient(rgba(0, 0, 0, 0.18) 1px, transparent 1px);

  background-repeat:
    repeat-y,
    repeat-y,
    no-repeat,
    no-repeat,
    repeat;

  background-size:
    460px auto,
    460px auto,
    24vw 100%,
    24vw 100%,
    6px 6px;

  background-position:
    left top,
    right top,
    left top,
    right top,
    0 0;

  opacity: 0.42;
}

/* =========================
   TREELINE LAYER
   Must be above camo, below content
   ========================= */

body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;

  background-image:
    /* Tall pine treeline, repeats across bottom */
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 900' preserveAspectRatio='none'%3E%3Cg fill='rgba(0,0,0,0.90)'%3E%3Cpath d='M0 900 L0 520 L40 420 L70 520 L110 360 L150 560 L200 330 L250 620 L300 390 L350 700 L400 420 L450 740 L500 460 L550 860 L600 480 L650 740 L700 420 L750 700 L800 390 L850 620 L900 330 L950 560 L990 360 L1030 520 L1060 420 L1100 520 L1100 900 Z'/%3E%3Cpath d='M1100 900 L1100 520 L1140 420 L1170 520 L1200 520 L1200 900 Z'/%3E%3Cpath d='M0 900 L0 520 L30 440 L55 520 L95 380 L130 560 L175 350 L215 610 L265 380 L315 690 L365 410 L415 730 L465 450 L515 845 L565 470 L615 730 L665 410 L715 690 L765 380 L815 610 L865 350 L905 560 L945 380 L970 520 L1000 440 L1030 520 L1030 900 Z' opacity='0.92'/%3E%3C/g%3E%3C/svg%3E"),
    /* Fog fade above the trees */
    linear-gradient(
      to top,
      rgba(0, 0, 0, 0.70) 0%,
      rgba(10, 18, 14, 0.46) 30%,
      rgba(10, 18, 14, 0.22) 56%,
      rgba(10, 18, 14, 0) 86%
    );

  background-repeat:
    repeat-x,
    repeat-x;

  background-size:
    1200px 980px,
    100% 980px;

  background-position:
    left bottom,
    center bottom;

  opacity: 0.92;
}

/* =========================
   GLOBAL TEXT PALETTE
   ========================= */

html,
body,
#quartz-root,
#quartz-body {
  color: #e6ebe7;
}

.page-meta,
.content-meta,
.breadcrumb,
.breadcrumbs,
.left.sidebar,
.right.sidebar,
.toc,
.graph,
footer {
  color: #9aa8a0;
}

a {
  color: #7fb4ff;
}

a:hover {
  color: #a7c9ff;
}

.center article h1,
.center article h2,
.center article h3,
.center article h4,
.center article h5,
.center article h6 {
  color: #f1f5f2;
}

code,
pre {
  color: #e6ebe7;
}

/* =========================
   FORCE DARK MODE ONLY
   ========================= */

:root {
  color-scheme: dark !important;
}

html[data-theme="light"],
html[data-theme="light"] body {
  background-color: #0a120e !important;
  color: #e6ebe7 !important;
}

html,
html[data-theme],
html[data-theme="dark"] {
  --background: #0a120e !important;
  --text: #e6ebe7 !important;
}

/* =========================
   REMOVE TOGGLES
   ========================= */

button[aria-label*="theme"],
button[title*="theme"],
button[aria-label*="dark"],
button[aria-label*="light"],
a[aria-label*="theme"],
a[title*="theme"],
svg[data-icon*="moon"],
svg[data-icon*="sun"],
.theme-toggle,
.theme-switch,
.darkmode-toggle,
.lightmode-toggle {
  display: none !important;
}

button[aria-label*="reader"],
button[title*="reader"],
button[aria-label*="book"],
button[title*="book"],
a[aria-label*="reader"],
a[title*="reader"],
a[aria-label*="book"],
a[title*="book"],
svg[data-icon*="book"],
.book,
.book-toggle,
.reader-toggle {
  display: none !important;
}

/* =========================
   EXPLORER ACTIVE LINK + CHEVRON
   ========================= */

.explorer-content a.is-active {
  background-color: rgba(96, 163, 255, 0.24);
  color: #eef4f0;
  border-radius: 8px;
  box-shadow: inset 2px 0 0 rgba(96, 163, 255, 0.75);
}

.explorer-content a.is-active::after {
  background: rgba(96, 163, 255, 0.22);
}

.explorer-content a:not(.folder-title):hover {
  background-color: rgba(96, 163, 255, 0.15);
  color: #eef4f0;
  border-radius: 8px;
}

.explorer-content .explorer-ul > li > a:not(.folder-title),
.explorer-content ul.content > li > a:not(.folder-title) {
  position: relative;
  padding-left: 28px;
  transition: background-color 220ms ease, color 220ms ease;
}

.explorer-content .explorer-ul > li > a:not(.folder-title)::before,
.explorer-content ul.content > li > a:not(.folder-title)::before {
  content: "›";
  position: absolute;
  left: 12px;
  top: 50%;
  font-size: 1.15rem;
  line-height: 1;
  color: rgba(96, 163, 255, 0.9);
  transform: translateY(-50%) translateX(-2px);
  opacity: 0;
  transition: opacity 220ms ease, transform 220ms ease;
}

.explorer-content .explorer-ul > li > a:not(.folder-title):hover::before,
.explorer-content ul.content > li > a:not(.folder-title):hover::before {
  opacity: 0.95;
  transform: translateY(-50%) translateX(0);
}

.explorer-content a.is-active::before {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
  color: rgba(96, 163, 255, 0.98);
}

/* =========================
   TOC CHEVRON
   ========================= */

.toc li {
  position: relative;
}

.toc li > a {
  display: block;
  padding-left: 24px !important;
  border-radius: 6px;
}

.toc li::before {
  content: "›";
  position: absolute;
  left: 8px;
  top: 50%;
  font-size: 1.05rem;
  line-height: 1;
  color: rgba(96, 163, 255, 0.9);
  transform: translateY(-50%) translateX(-2px);
  opacity: 0;
  transition: opacity 220ms ease, transform 220ms ease;
  pointer-events: none;
}

.toc li:hover::before {
  opacity: 0.95;
  transform: translateY(-50%) translateX(0);
}

.toc li:has(> a.active)::before {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
  color: rgba(96, 163, 255, 0.98);
}

.toc li > a:hover {
  background-color: rgba(96, 163, 255, 0.12);
}

@media (prefers-reduced-motion: reduce) {
  .toc li::before,
  .explorer-content .explorer-ul > li > a:not(.folder-title),
  .explorer-content ul.content > li > a:not(.folder-title),
  .explorer-content .explorer-ul > li > a:not(.folder-title)::before,
  .explorer-content ul.content > li > a:not(.folder-title)::before {
    transition: none !important;
  }
}
